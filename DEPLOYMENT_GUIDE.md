# ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ å¿…é ˆã®GitHub Secretsè¨­å®š

ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®Secretsã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### è¨­å®šæ‰‹é †

1. GitHubãƒªãƒã‚¸ãƒˆãƒªã«ã‚¢ã‚¯ã‚»ã‚¹: https://github.com/itoshu008/kintai
2. `Settings` â†’ `Secrets and variables` â†’ `Actions`
3. `New repository secret` ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ä»¥ä¸‹ã®å„Secretã‚’è¿½åŠ 

### å¿…è¦ãªSecrets

| Secretå | èª¬æ˜ | ä¾‹ |
|---------|------|-----|
| `SSH_HOST` | VPSã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ | `zatint1991.com` ã¾ãŸã¯ `202.233.67.137` |
| `SSH_USER` | SSHæ¥ç¶šãƒ¦ãƒ¼ã‚¶ãƒ¼å | `zatint1991-hvt55` |
| `SSH_PRIVATE_KEY` | SSHç§˜å¯†éµã®ä¸­èº« | `-----BEGIN OPENSSH PRIVATE KEY-----...` |
| `SSH_PORT` | SSHãƒãƒ¼ãƒˆç•ªå· | `22` |
| `SUDO_PASS` | sudoãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ | (å®Ÿéš›ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰) |

## ğŸ” SSHç§˜å¯†éµã®å–å¾—æ–¹æ³•

### æ–¹æ³•1: æ—¢å­˜ã®éµã‚’ä½¿ç”¨

```bash
# ç§˜å¯†éµã®å†…å®¹ã‚’è¡¨ç¤º
cat ~/.ssh/id_rsa
```

### æ–¹æ³•2: æ–°ã—ã„éµã‚’ç”Ÿæˆ

```bash
# SSHéµãƒšã‚¢ã‚’ç”Ÿæˆ
ssh-keygen -t rsa -b 4096 -C "github-actions@zatint1991.com" -f ~/.ssh/kintai_deploy

# å…¬é–‹éµã‚’ã‚µãƒ¼ãƒãƒ¼ã«è¿½åŠ 
ssh-copy-id -i ~/.ssh/kintai_deploy.pub zatint1991-hvt55@zatint1991.com

# ç§˜å¯†éµã®å†…å®¹ã‚’è¡¨ç¤ºï¼ˆã“ã‚Œã‚’GitHub Secretsã«è¨­å®šï¼‰
cat ~/.ssh/kintai_deploy
```

## âš ï¸ ç¾åœ¨ã®çŠ¶æ…‹

**SecretsãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚**

ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ï¼š
- `ssh: no key found` - SSHç§˜å¯†éµãŒç„¡åŠ¹
- `ssh: unable to authenticate` - èªè¨¼å¤±æ•—

## âœ… ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œæ‰‹é †

1. **GitHub Secretsã‚’è¨­å®š**ï¼ˆä¸Šè¨˜å‚ç…§ï¼‰
2. **Secretsã‚’ç¢ºèª**
   - GitHub Actions â†’ æœ€æ–°ã®å®Ÿè¡Œ â†’ Preflight - Check secrets
   - ã™ã¹ã¦ã®SecretsãŒ`SET`ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
3. **ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ**
   - `git push`ã™ã‚‹ã‹ã€GitHub Actions â†’ Run workflow

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### SSHæ¥ç¶šãƒ†ã‚¹ãƒˆ

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰æ¥ç¶šãƒ†ã‚¹ãƒˆ
ssh -p 22 zatint1991-hvt55@zatint1991.com

# éµã‚’æŒ‡å®šã—ã¦æ¥ç¶šãƒ†ã‚¹ãƒˆ
ssh -i ~/.ssh/kintai_deploy -p 22 zatint1991-hvt55@zatint1991.com
```

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼

1. **`ssh: no key found`**
   - SSH_PRIVATE_KEYãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“
   - ç§˜å¯†éµã®å…¨å†…å®¹ï¼ˆ`-----BEGIN`ã‹ã‚‰`-----END`ã¾ã§ï¼‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„

2. **`ssh: unable to authenticate`**
   - å…¬é–‹éµãŒã‚µãƒ¼ãƒãƒ¼ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“
   - `ssh-copy-id`ã§å…¬é–‹éµã‚’è¿½åŠ ã—ã¦ãã ã•ã„

3. **`Permission denied`**
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¾ãŸã¯éµãŒé–“é•ã£ã¦ã„ã¾ã™
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ç¢ºèªã—ã¦ãã ã•ã„

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€GitHub Actionsã®ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

